<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Survey Pro | Jakub KURPANIK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f0f2f5; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        .card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 16px; shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        .btn-primary { background-color: #0284c7; color: white; padding: 12px; border-radius: 8px; width: 100%; font-weight: 600; transition: background 0.2s; }
        .btn-primary:active { background-color: #0369a1; transform: scale(0.98); }
    </style>
</head>
<body class="max-w-md mx-auto p-4 pb-20">

    <header class="mb-6 text-center">
        <h1 class="text-2xl font-bold text-slate-900">Site Survey Tool</h1>
        <p class="text-sm text-slate-500 font-medium">Author: Jakub KURPANIK</p>
    </header>

    <div id="surveyForm">
        <div class="card">
            <h2 class="text-lg font-bold mb-4 text-blue-800 border-b pb-2">New Report</h2>
            
            <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Site Name</label>
            <input type="text" id="siteName" placeholder="e.g. London Office Block" class="w-full p-3 border border-gray-300 rounded-lg mb-4 focus:ring-2 focus:ring-blue-500 outline-none">
            
            <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Date of Inspection</label>
            <input type="date" id="surveyDate" class="w-full p-3 border border-gray-300 rounded-lg mb-4 outline-none">

            <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Safety Status</label>
            <select id="safetyStatus" class="w-full p-3 border border-gray-300 rounded-lg mb-4 outline-none">
                <option value="Green">Compliant (Green)</option>
                <option value="Yellow">Minor Issues (Yellow)</option>
                <option value="Red">Action Required (Red)</option>
            </select>
            
            <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Observations</label>
            <textarea id="notes" rows="4" class="w-full p-3 border border-gray-300 rounded-lg mb-4 outline-none" placeholder="Notes on progress or hazards..."></textarea>
            
            <button onclick="saveSurvey()" class="btn-primary">
                Save Report Locally
            </button>
        </div>
    </div>

    <div id="historySection">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-slate-800">Saved History</h2>
            <button onclick="clearLogs()" class="text-xs text-red-500 font-semibold underline">Clear All</button>
        </div>
        <div id="reportList">
            </div>
    </div>

    <script>
        // Load reports immediately when the page opens
        document.addEventListener('DOMContentLoaded', function() {
            renderReports();
            // Set default date to today
            document.getElementById('surveyDate').valueAsDate = new Date();
        });

        function saveSurvey() {
            const site = document.getElementById('siteName').value;
            const date = document.getElementById('surveyDate').value;
            const notes = document.getElementById('notes').value;
            const safety = document.getElementById('safetyStatus').value;

            if (!site) {
                alert("Please enter a Site Name");
                return;
            }

            const newReport = {
                site: site,
                date: date,
                notes: notes,
                safety: safety,
                id: Date.now()
            };

            // Get existing data
            let reports = JSON.parse(localStorage.getItem('siteReports') || '[]');
            
            // Add new report to the start of the list
            reports.unshift(newReport);
            
            // Save back to storage
            localStorage.setItem('siteReports', JSON.stringify(reports));
            
            // Clear form
            document.getElementById('siteName').value = '';
            document.getElementById('notes').value = '';
            
            // Refresh the list visually
            renderReports();
            alert("Report saved successfully!");
        }

        function renderReports() {
            const list = document.getElementById('reportList');
            const reports = JSON.parse(localStorage.getItem('siteReports') || '[]');
            
            if (reports.length === 0) {
                list.innerHTML = '<p class="text-gray-400 text-center italic mt-4">No reports saved yet.</p>';
                return;
            }

            list.innerHTML = reports.map(r => `
                <div class="card border-l-4 ${r.safety === 'Red' ? 'border-red-500' : r.safety === 'Yellow' ? 'border-yellow-500' : 'border-green-500'}">
                    <div class="flex justify-between items-start">
                        <h3 class="font-bold text-slate-900">${r.site}</h3>
                        <span class="text-xs font-mono text-gray-500">${r.date}</span>
                    </div>
                    <p class="text-sm text-gray-700 mt-2">${r.notes || 'No notes added.'}</p>
                    <div class="mt-3 text-[10px] font-bold uppercase tracking-wider ${r.safety === 'Red' ? 'text-red-600' : 'text-gray-500'}">
                        Status: ${r.safety}
                    </div>
                </div>
            `).join('');
        }

        function clearLogs() {
            if (confirm("Are you sure? This will delete all reports on this device.")) {
                localStorage.removeItem('siteReports');
                renderReports();
            }
        }
    </script>
</body>
</html>
